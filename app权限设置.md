# macOS 辅助功能权限解决方案

## 问题描述

macOS 的辅助功能权限只能授予给已签名的应用程序(.app)，而不能授予给脚本文件。这导致我们的 Swift 脚本无法使用 CGEventTap 监听全局键盘事件。

## 解决方案

### 方案: 创建应用包 (.app) 

**优点**: 完全符合 macOS 安全模型，功能完整
**缺点**: 需要额外步骤创建应用包

**步骤**:
1. 运行 `./create-app.sh` 创建应用包
2. 在系统偏好设置 > 安全性与隐私 > 隐私 > 辅助功能 中添加应用
3. 运行 `open "Context Collector.app"`

# Context Collector 权限授权指南

## 1. 授予辅助功能权限

### 步骤：
1. 打开 **系统偏好设置** (System Preferences)
2. 选择 **安全性与隐私** (Security & Privacy)
3. 点击 **隐私** (Privacy) 选项卡
4. 在左侧列表中选择 **辅助功能** (Accessibility)
5. 点击左下角的 **锁图标** 🔒 并输入密码解锁
6. 点击 **+** 按钮添加应用
7. 导航到 Context Collector 项目目录
8. 选择 **Context Collector.app** 并点击 **打开**
9. 确保应用旁边的复选框 ✅ 已选中
10. **每次build项目之后** macOS都会认为这是一个新的app 一定要先使用 **-** 去掉项目 之后再 **+** 

## 2. 验证权限设置

权限设置完成后，应用将能够：
- ✅ 监听全局键盘事件 (双击 Cmd+C)
- ✅ 读取剪贴板内容
- ✅ 弹出编辑窗口

- ✅ 保存文件到指定位置

## 3. 使用方法

1. **启动应用**：`open "Context Collector.app"`
2. **触发功能**：在任意应用中双击 Cmd+C (间隔 < 0.4秒)
3. **编辑内容**：在弹出的窗口中编辑文本
4. **保存文件**：点击保存按钮或使用快捷键

## 4. 故障排除

### 如果双击 Cmd+C 没有反应：
- 检查应用是否在运行（查看活动监视器）
- 确认辅助功能权限已正确授予
- 重启应用后再试

### 如果权限设置中找不到应用：
- 确保应用包在正确位置
- 尝试从Finder中直接拖拽应用到权限列表
- 检查应用包是否完整

## 5. 卸载说明

如需移除应用：
1. 从辅助功能权限列表中移除 Context Collector
2. 删除应用包：`rm -rf "Context Collector.app"`
3. 清理相关文件（如果有创建）